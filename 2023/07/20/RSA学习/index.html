<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title> | Hexo</title><link rel="stylesheet" type="text/css" href="/hack-tech/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/hack-tech/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/hack-tech/favicon.ico"><link rel="apple-touch-icon" href="/hack-tech/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/hack-tech/apple-touch-icon.png"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Hexo</h1><a id="logo" href="/hack-tech/.">Hexo</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/hack-tech/."><i class="fa fa-home"> Home</i></a><a href="/hack-tech/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/hack-tech/about/"><i class="fa fa-user"> About</i></a><a href="/hack-tech/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title"></h1><div class="post-meta">2023-07-20</div><div class="post-content"><h2 id="1-基本原理"><a href="#1-基本原理" class="headerlink" title="1 基本原理"></a>1 基本原理</h2><h3 id="公私钥的产生"><a href="#公私钥的产生" class="headerlink" title="公私钥的产生"></a>公私钥的产生</h3><ol>
<li>随机选择两个不同的大质数$p$和$q$，计算$N&#x3D;p \cdot q$</li>
<li>根据欧拉函数，求得$\varphi(N)&#x3D;\varphi(p)\varphi(q)&#x3D;(p-1)(q-1)$</li>
<li>选择一个小于$\varphi(N)$的整数$e$，使$e$和$\varphi(N)$互质。并求得$e$关于$\varphi(N)$的模反元素，命名为$d$，有$ed \equiv 1 \quad (mod \quad \varphi(N))$</li>
<li>将$p$和$q$的记录销毁</li>
</ol>
<p>此时，$(N,e)$是公钥，$(N,d)$是私钥。</p>
<h3 id="消息加密"><a href="#消息加密" class="headerlink" title="消息加密"></a>消息加密</h3><p>首先需要将消息以一个双方约定好的格式转化为一个小于$N$，且与$N$互质的整数$m$。如果消息太长，可以将消息分为几段，这也就是我们所说的块加密，后对于每一部分利用如下公式加密：<br>$$m^e \equiv c \quad (mod \quad N)$$</p>
<h3 id="消息解密"><a href="#消息解密" class="headerlink" title="消息解密"></a>消息解密</h3><p>利用秘钥$d$进行解密。<br>$$ c^d \equiv m \quad (mod \quad N) $$</p>
<h2 id="2-攻击——模数N"><a href="#2-攻击——模数N" class="headerlink" title="2 攻击——模数N"></a>2 攻击——模数N</h2><h3 id="暴力分解N"><a href="#暴力分解N" class="headerlink" title="暴力分解N"></a>暴力分解N</h3><p><strong>攻击方法1：</strong> 当N小于512 bits时，可以使用<a target="_blank" rel="noopener" href="http://factordb.com/">factordb</a>直接分解大整数<br><strong>攻击方法2：</strong> 椭圆曲线分解算法（ECM），参考<a target="_blank" rel="noopener" href="https://doc.sagemath.org/html/en/reference/interfaces/sage/interfaces/ecm.html">The Elliptic Curve Factorization Method</a></p>
<h3 id="p和q相差很大"><a href="#p和q相差很大" class="headerlink" title="p和q相差很大"></a>p和q相差很大</h3><p>此时，$p$和$q$二者之一的值很小，可以通过穷举试除来分解模数。</p>
<h3 id="p和q相差很小"><a href="#p和q相差很小" class="headerlink" title="p和q相差很小"></a>p和q相差很小</h3><p>首先，由于$N&#x3D;pq$，则有<br>$$ \frac{(p+q)^2}{4} -N &#x3D; \frac{(p+q)^2}{4} - pq &#x3D; \frac{(p-q)^2}{4} $$<br>由于$p$和$q$相差很小，则$\frac{(p-q)^2}{4}$的值较小，因为$\frac{(p+q)^2}{4}$略大于$N$，故而$\frac{p+q}{2}$与$\sqrt{N}$相近。然后可以按照如下方式分解：</p>
<ul>
<li>顺序检查从$\sqrt{N}$开始的每一个整数$x$，直至找到一个数满足$x^2-N$是平方数</li>
<li>根据上述等式，解出$p$和$q$。</li>
</ul>
<h3 id="p-1光滑"><a href="#p-1光滑" class="headerlink" title="p-1光滑"></a>p-1光滑</h3><p><strong>光滑数（Smooth number）</strong>：可以分解为小素数乘积的正整数</p>
<p>使用<code>Pollard&#39;s p-1</code>算法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> * </span><br><span class="line">a = <span class="number">2</span> </span><br><span class="line">n = <span class="number">2</span> </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>: </span><br><span class="line">	a = powmod(a, n, N) </span><br><span class="line">	res = gcd(a-<span class="number">1</span>, N) </span><br><span class="line">	<span class="keyword">if</span> res != <span class="number">1</span> <span class="keyword">and</span> res != N: </span><br><span class="line">		q = n // res </span><br><span class="line">		d = invert(e, (res-<span class="number">1</span>)*(q-<span class="number">1</span>)) </span><br><span class="line">		m = powmod(c, d, N) </span><br><span class="line">		<span class="built_in">print</span>(m) </span><br><span class="line">		<span class="keyword">break</span> </span><br><span class="line">	n += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h3 id="p-1光滑-1"><a href="#p-1光滑-1" class="headerlink" title="p+1光滑"></a>p+1光滑</h3><p>使用<code>Williams&#39;s p+1</code>算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">mlucas</span>(<span class="params">v, a, n</span>): </span><br><span class="line"><span class="string">&quot;&quot;&quot; Helper function for williams_pp1(). Multiplies along a Lucas sequence modulo n. &quot;&quot;&quot;</span> </span><br><span class="line">	v1, v2 = v, (v**<span class="number">2</span> - <span class="number">2</span>) % n </span><br><span class="line">	<span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">bin</span>(a)[<span class="number">3</span>:]: v1, v2 = ((v1**<span class="number">2</span> - <span class="number">2</span>) % n, (v1*v2 - v) % n) <span class="keyword">if</span> bit == <span class="string">&quot;0&quot;</span> <span class="keyword">else</span> ((v1*v2 - v) % n, (v2**<span class="number">2</span> - <span class="number">2</span>) % n) </span><br><span class="line">	<span class="keyword">return</span> v1 </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> count(<span class="number">1</span>): </span><br><span class="line">	<span class="keyword">for</span> p <span class="keyword">in</span> primegen(): </span><br><span class="line">		e = ilog(isqrt(n), p) </span><br><span class="line">		<span class="keyword">if</span> e == <span class="number">0</span>: <span class="keyword">break</span> </span><br><span class="line">		<span class="keyword">for</span> _ <span class="keyword">in</span> xrange(e): v = mlucas(v, p, n) </span><br><span class="line">		g = gcd(v-<span class="number">2</span>, n) </span><br><span class="line">		<span class="keyword">if</span> <span class="number">1</span> &lt; g &lt; n: <span class="keyword">return</span> g <span class="comment"># g|n </span></span><br><span class="line">		<span class="keyword">if</span> g == n: <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h3 id="模不互素"><a href="#模不互素" class="headerlink" title="模不互素"></a>模不互素</h3><p><strong>攻击原理：</strong> 当存在两个公钥的$N$不互素时，我们显然可以直接对这两个数求最大公因数，然后直接获得$p$和$q$，进而获得相应的私钥。</p>
<h3 id="共模攻击"><a href="#共模攻击" class="headerlink" title="共模攻击"></a>共模攻击</h3><p><strong>攻击条件：</strong> 当两个用户使用相同的模数$N$、不同的私钥时，加密同一明文消息时即存在共模攻击。</p>
<p><strong>攻击原理：</strong><br>设两个用户的公钥分别为$e_1$和$e_2$，且互质，明文消息为$m$，则密文为<br>$$\begin{align}<br>c_1&#x3D;m^{e_1} \ mod \ N \<br>c_2&#x3D;m^{e_2} \ mod \ N<br>\end{align}$$<br>当攻击者截获$c_1$和$c_2$后，用拓展欧几里得算法求出满足 $re_1+se_2&#x3D;1 \ mod \ N$ 的两个整数$r$和$s$，由此可得<br>$$\begin{align}<br>c_1^rc_2^s \equiv&amp; \ m^{re_1}m^{se_2} \ mod \ N \<br>\equiv&amp; \ m^{re_1+se_2} \ mod \ N \<br>\equiv&amp; \ m \ mod \ N<br>\end{align}$$</p>
<h2 id="3-攻击——公钥指数"><a href="#3-攻击——公钥指数" class="headerlink" title="3 攻击——公钥指数"></a>3 攻击——公钥指数</h2><h3 id="小公钥指数攻击"><a href="#小公钥指数攻击" class="headerlink" title="小公钥指数攻击"></a>小公钥指数攻击</h3><p><strong>攻击条件：</strong> $e$特别小，比如$e&#x3D;3$</p>
<p><strong>攻击原理：</strong><br>假设用户使用的秘钥$e&#x3D;3$。由于加密关系为<br>$$c \equiv m^3 \ mod \ N$$<br>则有<br>$$\begin{align}<br>m^3 &#x3D;&amp; c + kN \<br>m &#x3D;&amp; \sqrt[3]{c+kN}<br>\end{align}$$<br>攻击者可以从小到大枚举$k$，依次开三次根，直到开出整数为止。</p>
<h3 id="RSA衍生算法——Rabin算法"><a href="#RSA衍生算法——Rabin算法" class="headerlink" title="RSA衍生算法——Rabin算法"></a>RSA衍生算法——Rabin算法</h3><p><strong>攻击条件：</strong> Rabin算法的特征在于$e&#x3D;2$</p>
<h2 id="4-攻击——私钥d"><a href="#4-攻击——私钥d" class="headerlink" title="4 攻击——私钥d"></a>4 攻击——私钥d</h2><h3 id="私钥泄露"><a href="#私钥泄露" class="headerlink" title="私钥泄露"></a>私钥泄露</h3><p>私钥泄露后，自然可以解密密文，甚至可以对模数$N$进行分解。</p>
<p><strong>工具：</strong></p>
<ul>
<li>RsaConverter.exe (<a target="_blank" rel="noopener" href="https://sourceforge.net/projects/rsaconverter/">https://sourceforge.net/projects/rsaconverter/</a> , for windows )</li>
<li><a target="_blank" rel="noopener" href="https://github.com/ius/rsatool/blob/master/rsatool.py">rsatool.py</a></li>
</ul>
<h3 id="Wiener’s-Attack"><a href="#Wiener’s-Attack" class="headerlink" title="Wiener’s Attack"></a>Wiener’s Attack</h3><p><strong>攻击条件：</strong> $d&lt;\frac{1}{3}N^{\frac{1}{4}}$</p>
<p><strong>攻击原理：</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Wiener%27s_attack">https://en.wikipedia.org/wiki/Wiener%27s_attack</a></li>
<li><a target="_blank" rel="noopener" href="https://sagi.io/2016/04/crypto-classics-wieners-rsa-attack/">https://sagi.io/2016/04/crypto-classics-wieners-rsa-attack/</a></li>
</ul>
<p><strong>工具：</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/pablocelayes/rsa-wiener-attack">https://github.com/pablocelayes/rsa-wiener-attack</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/orisano/owiener">https://github.com/orisano/owiener</a></li>
</ul>
<h3 id="Extending-Wiener’s-Attack"><a href="#Extending-Wiener’s-Attack" class="headerlink" title="Extending Wiener’s Attack"></a>Extending Wiener’s Attack</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.sci-hub.ren/https://link.springer.com/chapter/10.1007/3-540-46701-7_14">《Extending Wiener’s Attack in the Presence of Many Decrypting Exponents》</a></li>
<li><a target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/asymmetric/rsa/d_attacks/rsa_extending_wiener/">https://ctf-wiki.org/crypto/asymmetric/rsa/d_attacks&#x2F;rsa_extending_wiener&#x2F;</a></li>
</ul>
</div><div class="tags"></div><div class="post-nav"><a class="next" href="/hack-tech/2023/07/20/hello-world/">Hello World</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://qinglong-huang.github.io/hack-tech"/></form></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="About"><img class="nofancybox" src="/img/avatar.png"/></a><p>To be a better man.</p><a class="info-icon" href="https://twitter.com/username" title="Twitter" target="_blank" style="margin-inline:5px"> <i class="fa fa-twitter-square" style="margin-inline:5px"></i></a><a class="info-icon" href="mailto:admin@domain.com" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/username" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/hack-tech/2023/07/20/RSA%E5%AD%A6%E4%B9%A0/">RSA学习</a></li><li class="post-list-item"><a class="post-list-link" href="/hack-tech/2023/07/20/hello-world/">Hello World</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/hack-tech/." rel="nofollow">Hexo.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/hack-tech/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/hack-tech/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><script type="text/javascript" src="/hack-tech/js/copycode.js?v=1.0.0" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/hack-tech/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/hack-tech/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/hack-tech/js/smartresize.js?v=1.0.0"></script></div></body></html>